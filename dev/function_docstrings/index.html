<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function Docstrings · SwissVAMyKnife.jl</title><meta name="title" content="Function Docstrings · SwissVAMyKnife.jl"/><meta property="og:title" content="Function Docstrings · SwissVAMyKnife.jl"/><meta property="twitter:title" content="Function Docstrings · SwissVAMyKnife.jl"/><meta name="description" content="Documentation for SwissVAMyKnife.jl."/><meta property="og:description" content="Documentation for SwissVAMyKnife.jl."/><meta property="twitter:description" content="Documentation for SwissVAMyKnife.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SwissVAMyKnife.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">SwissVAMyKnife.jl</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><span class="tocitem">Ray Optical TVAM</span><ul><li><a class="tocitem" href="../ray_TVAM/">Simple Ray Optical TVAM</a></li><li><a class="tocitem" href="../ray_derivation/">Analytic Derivation of Vial Refraction</a></li></ul></li><li><a class="tocitem" href="../real_world_application/">Real World Application</a></li><li class="is-active"><a class="tocitem" href>Function Docstrings</a><ul class="internal"><li><a class="tocitem" href="#Geometry"><span>Geometry</span></a></li><li><a class="tocitem" href="#Optimization"><span>Optimization</span></a></li><li><a class="tocitem" href="#Optimizer"><span>Optimizer</span></a></li><li><a class="tocitem" href="#Loss-Function"><span>Loss Function</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Function Docstrings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Function Docstrings</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/main/docs/src/function_docstrings.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Geometry"><a class="docs-heading-anchor" href="#Geometry">Geometry</a><a id="Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.PropagationScheme" href="#SwissVAMyKnife.PropagationScheme"><code>SwissVAMyKnife.PropagationScheme</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type PropagationScheme end</code></pre><p>List of possible schemes:</p><ul><li><a href="#SwissVAMyKnife.ParallelRayOptics"><code>ParallelRayOptics</code></a></li><li><a href="#SwissVAMyKnife.WaveOptics"><code>WaveOptics</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/SwissVAMyKnife.jl#L28-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.ParallelRayOptics" href="#SwissVAMyKnife.ParallelRayOptics"><code>SwissVAMyKnife.ParallelRayOptics</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ParallelRayOptics(angles, μ)</code></pre><p>Type to represent the parallel ray optical approach. This is suited for a printer with an index matching bath. This is equivalent to an inverse (attenuated) Radon transform as the forward model of the printer. </p><ul><li><code>angles</code> is a range or <code>Vector</code> (or <code>CuVector</code>) storing the illumination angles.</li><li><code>μ</code> is the absorption coefficient of the resin in units of pixels.  So <code>μ=0.1</code> means that after ten pixels of propagation the intensity is <code>I(10) = I_0 * exp(-10 * 0.1)</code>.</li></ul><p>See also <a href="#SwissVAMyKnife.VialRayOptics"><code>VialRayOptics</code></a> for a printer without index matching bath.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; ParallelRayOptics(range(0, 2π, 401)[begin:end-1], 1 / 256)
ParallelRayOptics{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}(0.0:0.015707963267948967:6.267477343911637, 0.00390625)

julia&gt; ParallelRayOptics(range(0, 2π, 401)[begin:end-1], nothing)
ParallelRayOptics{Nothing, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}(0.0:0.015707963267948967:6.267477343911637, nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/ray_optics.jl#L62-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.VialRayOptics" href="#SwissVAMyKnife.VialRayOptics"><code>SwissVAMyKnife.VialRayOptics</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Type to represent a ray optical approach where refraction and reflection intensity loss at the glass vial is considered. This is equivalent to an inverse (attenuated) Radon transform as the forward model of the printer. </p><ul><li><code>angles</code> is a range or <code>Vector</code> (or <code>CuVector</code>) storing the illumination angles.</li><li><code>μ</code> is the absorption coefficient of the resin in units of pixels.</li><li>So <code>μ=0.1</code> means that after ten pixels of propagation the intensity is <code>I(10) = I_0 * exp(-10 * 0.1)</code>.</li><li><code>R_outer</code> is the outer radius of the glass vial.</li><li><code>R_inner</code> is the inner radius of the glass vial.</li><li><code>DMD_diameter</code> is the diameter of the DMD along the vial radius. So this is not the height along the rotation axis!</li><li><code>n_vial</code> is the refractive index of the glass vial.</li><li><code>n_resin</code> is the refractive index of the resin.</li><li><code>polarization=PolarizationRandom()</code> is the polarization of the light. See <a href="#SwissVAMyKnife.Polarization"><code>Polarization</code></a> for the options. </li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; VialRayOptics(angles=range(0,2π, 501)[begin:end-1],
                     μ=nothing,
                     R_outer=6e-3,
                     R_inner=5.5e-3,
                     DMD_diameter=2 * R_outer,
                     n_vial=1.47,
                     n_resin=1.48,
                     polarization=PolarizationRandom()
                     )</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/ray_optics.jl#L91-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.WaveOptics" href="#SwissVAMyKnife.WaveOptics"><code>SwissVAMyKnife.WaveOptics</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">WaveOptics(;z, λ, L, μ=nothing, angles)</code></pre><p><strong>Parameters</strong></p><ul><li><code>z</code>: the different depths we propagate the field. Should be <code>Vector</code> or range.</li><li><code>λ</code>: wavelength in the medium. So divide by the refractive index!</li><li><code>L</code>: The side length of the array. You should satisfy <code>L ≈ abs(z[begin]) + abs(z[end])</code></li><li><code>μ</code>: Absorption coefficient.</li><li><code>angles</code>: the angles we illuminate the sample. Should be <code>Vector</code> or range. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/wave_optics.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.Polarization" href="#SwissVAMyKnife.Polarization"><code>SwissVAMyKnife.Polarization</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Polarization</code></pre><ul><li><code>PolarizationParallel()</code> describes a parallel polarization.</li><li><code>PolarizationPerpendicular()</code> describes a perpendicular polarization. </li><li><code>PolarizationRandom()</code> describes a random polarization.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/ray_optics.jl#L5-L11">source</a></section></article><h2 id="Optimization"><a class="docs-heading-anchor" href="#Optimization">Optimization</a><a id="Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.optimize_patterns" href="#SwissVAMyKnife.optimize_patterns"><code>SwissVAMyKnife.optimize_patterns</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">optimize_patterns(target, ps::WaveOptics, op::GradientBased, loss::Union{LossThreshold, LossThresholdSparsity})</code></pre><p>Optimize the patterns to match the target with the wave optical model. <code>target</code> is the target intensity. <code>ps</code> is the wave optical model. <code>op</code> is the optimization method. <code>loss</code> is the loss function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/wave_optics.jl#L23-L30">source</a></section><section><div><pre><code class="language-julia hljs">optimize_patterns(target, ps::{VialRayOptics, ParallelRayOptics}, op::GradientBased, loss::LossTarget)</code></pre><p>Function to optimize a <code>target</code> volume. This method returns the optimized patterns, the printed intensity and the optimization result.</p><p>See <a href="#SwissVAMyKnife.VialRayOptics"><code>VialRayOptics</code></a> how to specify the geometry of the vial. See <a href="#SwissVAMyKnife.ParallelRayOptics"><code>ParallelRayOptics</code></a> how to specify the geometry of the vial.</p><p>See <a href="#SwissVAMyKnife.PropagationScheme"><code>PropagationScheme</code></a> for the options for the different propagation schemes. See <a href="#SwissVAMyKnife.OptimizationScheme"><code>OptimizationScheme</code></a> for the options for the different optimization schemes. See <a href="#SwissVAMyKnife.LossTarget"><code>LossTarget</code></a> for the options for the different loss functions.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; patterns, printed_intensity, res = optimize_patterns(target, VialRayOptics(angles=range(0,2π, 501)[begin:end-1],
                     μ=nothing,
                     R_outer=6e-3,
                     R_inner=5.5e-3,
                     n_vial=1.47,
                     n_resin=1.48,
                     polarization=PolarizationRandom()
                     ), GradientBased(), LossThreshold())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/ray_optics.jl#L134-L158">source</a></section><section><div><pre><code class="language-julia hljs">optimize_patterns(target::AbstractArray{T}, ps::ParallelRayOptics, op::OSMO) where T</code></pre><p>Optimize patterns with the <code>OSMO</code> optimization algorithm. This is only supported for <code>ParallelRayOptics</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; optimize_patterns(target, ParallelRayOptics(range(0, 2π, 401)[begin:end-1], 1 / 256), OSMO())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/ray_optics.jl#L253-L263">source</a></section></article><h2 id="Optimizer"><a class="docs-heading-anchor" href="#Optimizer">Optimizer</a><a id="Optimizer-1"></a><a class="docs-heading-anchor-permalink" href="#Optimizer" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.OptimizationScheme" href="#SwissVAMyKnife.OptimizationScheme"><code>SwissVAMyKnife.OptimizationScheme</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type OptimizationScheme end</code></pre><p>List of possible schemes:</p><p><strong><a href="#SwissVAMyKnife.GradientBased"><code>GradientBased</code></a></strong></p><p>Supported for all <code>&lt;:PropagationScheme</code>.</p><p><strong><a href="#SwissVAMyKnife.OSMO"><code>OSMO</code></a></strong></p><p>Supported only for <code>ParallelRayOptics</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/SwissVAMyKnife.jl#L37-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.GradientBased" href="#SwissVAMyKnife.GradientBased"><code>SwissVAMyKnife.GradientBased</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GradientBased(; optimizer=LBFSG(), options=Optim.options(iterations=30, store_trace=true))</code></pre><p>Define parameters for the <code>GradientBased</code> optimization algorithm. Optim.jl is used for the optimization. L-BFGS is the default optimizer which performs well for the optimization of the reconstruction problem. 30 iterations are used as default. The trace of the optimization is stored by default.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; GradientBased(; optimizer=LBFGS(), options=Optim.Options(iterations=30, store_trace=true))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/optimization.jl#L24-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.OSMO" href="#SwissVAMyKnife.OSMO"><code>SwissVAMyKnife.OSMO</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OSMO(; iterations=10, thresholds=(0.7f0, 0.8f0))</code></pre><p>Define parameters for the OSMO optimization algorithm. We recommend to use <a href="#SwissVAMyKnife.GradientBased"><code>GradientBased</code></a> instead of OSMO.</p><p><strong>Reference</strong></p><p>Rackson, Charles M., et al. <em>Object-space optimization of tomographic reconstructions for additive manufacturing.</em> Additive Manufacturing 48 (2021): 102367.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/optimization.jl#L5-L14">source</a></section></article><h2 id="Loss-Function"><a class="docs-heading-anchor" href="#Loss-Function">Loss Function</a><a id="Loss-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Loss-Function" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.LossTarget" href="#SwissVAMyKnife.LossTarget"><code>SwissVAMyKnife.LossTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LossTarget</code></pre><p>Abstract type for loss functions. </p><p>List of implemented loss functions:</p><ul><li><code>LossThreshold</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/loss.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SwissVAMyKnife.LossThreshold" href="#SwissVAMyKnife.LossThreshold"><code>SwissVAMyKnife.LossThreshold</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LossThreshold(;sum_f=abs2, thresholds=(0.65f0, 0.75f0))</code></pre><p>Loss function for polymerization.  Keeps the object voxels in the range <code>[T_U, 1]</code> and the empty space in the range <code>[0, T_L]</code>.</p><p class="math-container">\[\mathcal{L} = \underbrace{\sum_{v \,\in\,\text{object}} |\text{ReLu}(T_U - I_v)|^K}_\text{force object polymerization} + $$
$$+\underbrace{\sum_{v\,\notin\,\text{object}} |\text{ReLu}(I_v - T_L) |^K}_{\text{keep empty space unpolymerized}} +\]</p><p class="math-container">\[+\underbrace{\sum_{v \,\in\,\text{object}} |\text{ReLu}(I_v - 1)|^K}_{\text{avoid overpolymerization}}\]</p><ul><li>The default <code>K=2</code> corresponds to <code>sum_f=abs2</code>.</li><li><code>(T_L, T_U) = thresholds</code></li></ul><pre><code class="language-julia-repl hljs">julia&gt; l = LossThreshold(thresholds=(0.5, 0.7))
LossThreshold{typeof(abs2), Float64}(abs2, (0.5, 0.7))

julia&gt; x = [1.0, 0.0, 0.55]
3-element Vector{Float64}:
 1.0
 0.0
 0.55

julia&gt; target = [1, 0, 1]
3-element Vector{Int64}:
 1
 0
 1

julia&gt; l(x, target, nothing)
0.022499999999999975

julia&gt; (0.7 - 0.55)^2
0.022499999999999975
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPFL-LAPD/SwissVAMyKnife.jl/blob/827809a109b9880c61c57a2e9837b4c976d5c521/src/loss.jl#L14-L50">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../real_world_application/">« Real World Application</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 8 April 2024 12:24">Monday 8 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
